<!--

This comment is needed in order to push the following strings on transifex

<span data-translate>Delete</span>

-->

<br />
<div data-ng-controller="AdminStepAddCtrl">
  <h4><span data-translate>Add new step</span></h4>
  <div data-ng-form="" name="newStep">
    <div class="row">
      <div class="col-md-12">
        <div class="form-group">
          <label data-translate>Label</label>
          <input class="form-control" data-ng-model="new_step_label" type="text" required>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <div class="form-group">
          <button class="pull-left btn btn-success" data-ng-disabled="newStep.$invalid" data-ng-click="add_step()">
            <i class="glyphicon glyphicon-ok"></i>
            <span data-translate>Add</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<br /><br />
<div data-ng-if="context.steps.length">
  <h4><span data-translate>Configured steps:</span></h4>
  <div ui-sortable data-ng-model="context.steps">
    <div data-ng-repeat="step in context.steps">
      <div class="step" data-ng-controller="AdminStepEditorCtrl">
        <div class="stepEditorHeader" data-ng-init="editing=false" data-ng-click="editing=!editing">
          <b>{{$index}})</b> {{step.label}}&nbsp;
          <div class="pull-right" data-ng-show="editing">
            <button class="btn btn-xs btn-danger" data-ng-click="deleteStep(step)" popover="{{ Delete | translate }}" popover-placement="right" popover-trigger="mouseenter">
              <i class="glyphicon glyphicon-remove"></i>
            </button>
          </div>
        </div>
        <div data-ng-form="" name="editStep" class="stepEditorBody" data-ng-show=editing>
          <div class="form-group">
            <label data-translate>Label</label>
            <input class="form-control" data-ng-model="step.label" type="text">
          </div>
          <div class="form-group">
            <label data-translate>Hint</label>
            <input class="form-control" data-ng-model="step.hint" type="text">
          </div>
          <div class="form-group">
            <label data-translate>Description</label>
            <div>
              <textarea class="form-control" data-ng-model="step.description">{{step.description}}</textarea>
            </div>
          </div>
          <div class="form-group">
            <label data-translate>Add field</label>
            <div class="input-group">
              <select data-ng-model="field_to_add" data-ng-options="item.id as item.label for item in admin.fields | orderBy:'name'" class="form-control"></select>
              <span class="input-group-btn">
                <button data-ng-click="add_field_to_step()" class="btn btn-primary" data-ng-disabled="!field_to_add || field_to_add == ''" type="button">
                  <i class="glyphicon glyphicon-plus-sign"></i>
                </button>
              </span>
            </div>
          </div>
          <div class="form-group" data-ng-if="step.children.length">
            <label data-translate>Configured fields:</label>
              <div ui-sortable data-ng-model="step.children">
                <div data-ng-repeat="field in step.children">
                  <div class="field">
                    <b>{{$index}})</b> {{indexed_fields[field]}}&nbsp;
                    <div class="pull-right" data-ng-show="editing">
                      <button class="btn btn-xs btn-danger" data-ng-click="deleteField(field)" popover="{{ Delete | translate }}" popover-placement="right" popover-trigger="mouseenter">
                        <i class="glyphicon glyphicon-remove"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
