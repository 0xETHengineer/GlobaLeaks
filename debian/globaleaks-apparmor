#include <tunables/global>

profile usr.bin.globaleaks {

    #include <abstractions/base>
    #include <abstractions/nameservice>

    capability setgid,
    capability setuid,

    /proc/*/mounts r,

    /usr/bin/ r,
    /usr/bin/globaleaks r,

    /usr/share/pyshared/** r,
    /usr/lib/python2.7/** mr,
    /usr/local/lib/python2.7/** mr,
    /etc/python2.7/** r,
    /etc/mime.types r,

    deny /usr/lib/python2.7/dist-packages/globaleaks/** rwlk,
    deny /bin/dash rx,

    /var/globaleaks/** rwk,
    owner /tmp/** rwkl,
    owner /var/tmp/** rwkl,
}
