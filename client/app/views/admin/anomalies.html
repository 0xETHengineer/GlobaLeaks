<!-- 

This comment is needed in order to push the following strings on transifex

<span data-translate>System Checks</span>
<span data-translate>Anomaly Checks</span>
<span data-translate>Administration Interface</span>
<span data-translate>Here you can check the latest anomalies detected</span>

-->
<div id="ContentBox" class="container" data-ng-controller="AnomaliesCtrl">
  <div class="row">
    <div id="ConfigSidebarBox" class="col-md-3" data-ng-include="'views/admin/sidebar.html'"></div>
    <div class="col-md-9">
      <div class="row">
        <div class="col-md-12">
          <div data-translate>This interface shows you the anomalous behavior spotted by the system.</div>
          <div data-translate>Anomaly are analyzed automatically in order to spot abuses or atypical usage bursts.</div>
          <div data-translate>Being the GlobaLeaks user anonymous, the system can't perform anomaly detection based on per user policies.</div>
          <div data-translate>Currently policy adopted to identify anomalies is to check some thresholds using an observation window of 30 seconds.</div>
          <div data-translate>The following are the thresholds used to identify an anomalous behaviour:</div>

          <div id="AnomaliesThresholdsSummary" data-ng-show="showLevel">
            <span class="label label-info" data-translate>Login Failures</span>: 5<br />
            <span class="label label-info" data-translate>Login Successes</span>: 3<br />
            <span class="label label-info" data-translate>Submissions Started</span>: 5<br />
            <span class="label label-info" data-translate>Submissions Completed</span>: 4<br />
            <span class="label label-info" data-translate>Whistleblower Comments</span>: 4<br />
            <span class="label label-info" data-translate>Whistleblower Messages</span>: 4<br />
            <span class="label label-info" data-translate>Uploaded Files</span>: 11<br />
            <span class="label label-info" data-translate>Receiver Comments</span>: 3<br />
            <span class="label label-info" data-translate>Receiver Messages</span>: 3<br />
          </div>

          <table id="AnomaliesHistoryTable" class="table table-bordered">
          <thead>
              <tr>
                <th class="col-md-2">
                  <span data-translate>Date</span>
                </th>
                <th class="col-md-1">
                  <span data-translate>Alarm Level</span>
                </th>
                <th class="col-md-2">
                  <span data-translate>Events</span>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr data-ng-repeat="hanomaly in hanomalies">
                <td class="col-md-2">
                  {{hanomaly.when | date:'dd-MM-yyyy HH:mm'}}
                </td>
                <td class="col-md-1">
                  {{hanomaly.alarm}}
                </td>
                <td class="col-md-2">
                  <span data-ng-repeat="single_event in hanomaly.events">
                    <span class="label label-info">{{single_event.name}}</span> {{single_event.amount}}<br>
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

      </div>
    </div>
  </div>
</div>

